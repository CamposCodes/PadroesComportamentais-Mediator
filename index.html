<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sistema Bar e Cafeteria - Mediator Pattern</title>
</head>
<body>
    <div class="container">
        <h1>üè¢ Sistema Bar/Cafeteria - Mediator Pattern</h1>

        <!-- Estat√≠sticas -->
        <div class="stats" role="region" aria-label="Estat√≠sticas do Mediator">
            <div class="stat" id="totalOrders" aria-live="polite">
                <div class="stat-icon">üìã</div>
                <div class="stat-content">
                    <div class="stat-number">0</div>
                    <div class="stat-label">Total de Pedidos</div>
                </div>
            </div>

            <div class="stat" id="mediatorCalls" aria-live="polite">
                <div class="stat-icon">üéØ</div>
                <div class="stat-content">
                    <div class="stat-number">0</div>
                    <div class="stat-label">Chamadas ao Mediador</div>
                </div>
            </div>

            <div class="stat" id="avgTime" aria-live="polite">
                <div class="stat-icon">‚è±Ô∏è</div>
                <div class="stat-content">
                    <div class="stat-number">0 ms</div>
                    <div class="stat-label">Tempo M√©dio</div>
                </div>
            </div>

            <div class="stat" id="barOrders" aria-live="polite">
                <div class="stat-icon">üç∫</div>
                <div class="stat-content">
                    <div class="stat-number">0</div>
                    <div class="stat-label">Pedidos Bar</div>
                </div>
            </div>

            <div class="stat" id="kitchenOrders" aria-live="polite">
                <div class="stat-icon">üç≥</div>
                <div class="stat-content">
                    <div class="stat-number">0</div>
                    <div class="stat-label">Pedidos Cozinha</div>
                </div>
            </div>

            <div class="stat" id="baristaOrders" aria-live="polite">
                <div class="stat-icon">‚òï</div>
                <div class="stat-content">
                    <div class="stat-number">0</div>
                    <div class="stat-label">Pedidos Barista</div>
                </div>
            </div>
        </div>

        <!-- Controles -->
        <div class="card">
            <h2>Controles de Simula√ß√£o</h2>
            <div class="control-group">
                <div class="waiter-select">
                    <label for="waiterSelect">Gar√ßom:</label>
                    <select id="waiterSelect">
                        <option value="joao">üë®‚Äçüíº Jo√£o</option>
                        <option value="maria">üë©‚Äçüíº Maria</option>
                        <option value="pedro">üë®‚Äçüíº Pedro</option>
                        <option value="ana">üë©‚Äçüíº Ana</option>
                    </select>
                </div>
                <div class="order-type-select">
                    <label for="orderType">Tipo de Pedido:</label>
                    <select id="orderType">
                        <option value="random">üé≤ Aleat√≥rio</option>
                        <option value="bebida-alcoolica">üç∫ Bebida Alco√≥lica</option>
                        <option value="alimento">üç≥ Alimento</option>
                        <option value="bebida-especial">‚òï Bebida Especial</option>
                    </select>
                </div>
            </div>
            <div class="buttons">
                <button class="add" onclick="addSingleOrder()">+ Adicionar Pedido</button>
                <button class="bulk-10" onclick="addBulkOrders(10)">+ 10 Pedidos</button>
                <button class="bulk-50" onclick="addBulkOrders(50)">+ 50 Pedidos</button>
                <button class="bulk-100" onclick="addBulkOrders(100)">+ 100 Pedidos</button>
                <button class="clear" onclick="clearOrders()">Limpar Tudo</button>
            </div>
        </div>

        <!-- Lista de pedidos -->
        <div class="card orders" id="ordersList">
            <h2>Pedidos Recentes (<span id="orderCount">0</span>)</h2>
            <div id="ordersContainer">Nenhum pedido ainda. Clique em "Adicionar Pedido".</div>
        </div>

        <!-- Explica√ß√£o -->
        <div class="card">
            <h3>üéì Como Funciona o Mediator Pattern</h3>
            <div class="explanation">
                <div class="concept">
                    <strong>üéØ O Padr√£o Mediator:</strong>
                    <p>Centraliza a comunica√ß√£o entre m√∫ltiplos objetos (gar√ßons e setores) atrav√©s de um objeto mediador (CozinhaBar).</p>
                </div>
                <div class="concept">
                    <strong>üîÑ Fluxo de Comunica√ß√£o:</strong>
                    <p>Gar√ßom ‚Üí CozinhaBar (Mediador) ‚Üí Setor Apropriado (Bar/Cozinha/Barista)</p>
                </div>
                <div class="concept">
                    <strong>‚úÖ Vantagens:</strong>
                    <ul style="margin: 8px 0 0 0;">
                        <li>Reduz acoplamento entre objetos</li>
                        <li>Centraliza l√≥gica de comunica√ß√£o</li>
                        <li>Facilita manuten√ß√£o e extens√£o</li>
                        <li>Controle centralizado de fluxo</li>
                    </ul>
                </div>
                <div class="concept">
                    <strong>‚ö° Padr√µes Complementares:</strong>
                    <p><strong>Singleton:</strong> CozinhaBar, Bar, Cozinha e Barista existem em √∫nica inst√¢ncia</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        const ordersContainer = document.getElementById('ordersContainer');
        const orderCountSpan = document.getElementById('orderCount');

        const waiterNames = {
            'joao': 'üë®‚Äçüíº Jo√£o',
            'maria': 'üë©‚Äçüíº Maria',
            'pedro': 'üë®‚Äçüíº Pedro',
            'ana': 'üë©‚Äçüíº Ana'
        };

        const orderTypes = {
            'bebida-alcoolica': { label: 'üç∫ Bebida Alco√≥lica', icon: 'üç∫', sector: 'bar', products: ['Cerveja', 'Chopp', 'Vinho', 'Vodka', 'Cacha√ßa', 'Rum', 'Whisky'] },
            'alimento': { label: 'üç≥ Alimento', icon: 'üç≥', sector: 'cozinha', products: ['Feijoada', 'Frango √† Parmegiana', 'Sushi', 'Pizza', 'Hamb√∫rguer', 'Costela', 'Bife'] },
            'bebida-especial': { label: '‚òï Bebida Especial', icon: '‚òï', sector: 'barista', products: ['Cappuccino', 'Latte', 'Espresso', 'Mocha', 'Macchiato', 'Caf√© com Canela'] }
        };

        const sectorEmojis = {
            'bar': 'üç∫',
            'cozinha': 'üç≥',
            'barista': '‚òï'
        };

        const sectorNames = {
            'bar': 'Bar',
            'cozinha': 'Cozinha',
            'barista': 'Barista'
        };

        const sectorTimes = {
            'bar': 3,
            'cozinha': 15,
            'barista': 5
        };

        let orders = [];
        let stats = {
            totalOrders: 0,
            mediatorCalls: 0,
            processingTimes: [],
            sectorOrders: { bar: 0, cozinha: 0, barista: 0 }
        };

        // Simula√ß√£o do Padr√£o Mediator
        const mediator = {
            processOrder: function(waiter, orderType, product, sector) {
                const startTime = performance.now();
                
                // Simula o processamento atrav√©s do mediador
                const result = {
                    mediatorMessage: `CozinhaBar recebeu o pedido de ${waiter}`,
                    sectorMessage: `${sectorNames[sector]} est√° preparando: ${product}`,
                    estimatedTime: sectorTimes[sector]
                };

                const endTime = performance.now();
                const processingTime = Math.round(endTime - startTime);
                
                stats.mediatorCalls++;
                stats.processingTimes.push(processingTime);
                
                return { ...result, processingTime };
            }
        };

        function getRandomProduct(orderType) {
            if (orderType === 'random') {
                const types = Object.keys(orderTypes).filter(t => t !== 'random');
                orderType = types[Math.floor(Math.random() * types.length)];
            }
            const typeData = orderTypes[orderType];
            return {
                type: orderType,
                product: typeData.products[Math.floor(Math.random() * typeData.products.length)],
                icon: typeData.icon,
                sector: typeData.sector,
                label: typeData.label
            };
        }

        function addSingleOrder() {
            const waiterKey = document.getElementById('waiterSelect').value;
            const orderTypeKey = document.getElementById('orderType').value;
            const waiterName = waiterNames[waiterKey];
            
            const orderData = getRandomProduct(orderTypeKey);
            
            const timestamp = new Date().toLocaleTimeString('pt-BR');
            
            const result = mediator.processOrder(
                waiterName,
                orderData.type,
                orderData.product,
                orderData.sector
            );

            const order = {
                waiter: waiterName,
                product: orderData.product,
                icon: orderData.icon,
                sector: orderData.sector,
                sectorName: sectorNames[orderData.sector],
                timestamp,
                processingTime: result.processingTime,
                estimatedTime: result.estimatedTime
            };

            orders.push(order);
            stats.totalOrders++;
            stats.sectorOrders[orderData.sector]++;
            
            updateDisplay();
            updateStats();
        }

        function addBulkOrders(count) {
            for (let i = 0; i < count; i++) {
                const waiterKey = ['joao', 'maria', 'pedro', 'ana'][Math.floor(Math.random() * 4)];
                const orderTypeKey = ['bebida-alcoolica', 'alimento', 'bebida-especial'][Math.floor(Math.random() * 3)];
                
                const waiterName = waiterNames[waiterKey];
                const orderData = getRandomProduct(orderTypeKey);
                
                const timestamp = new Date().toLocaleTimeString('pt-BR');
                
                const result = mediator.processOrder(
                    waiterName,
                    orderData.type,
                    orderData.product,
                    orderData.sector
                );

                const order = {
                    waiter: waiterName,
                    product: orderData.product,
                    icon: orderData.icon,
                    sector: orderData.sector,
                    sectorName: sectorNames[orderData.sector],
                    timestamp,
                    processingTime: result.processingTime,
                    estimatedTime: result.estimatedTime
                };

                orders.push(order);
                stats.totalOrders++;
                stats.sectorOrders[orderData.sector]++;
            }
            
            updateDisplay();
            updateStats();
        }

        function updateDisplay() {
            document.getElementById('orderCount').innerText = orders.length;
            ordersContainer.innerHTML = '';

            if (orders.length === 0) {
                ordersContainer.innerHTML = 'Nenhum pedido ainda. Clique em "Adicionar Pedido".';
                return;
            }

            const recent = orders.slice(-100).reverse();
            recent.forEach((order) => {
                const div = document.createElement('div');
                div.className = 'order';

                const iconSpan = document.createElement('span');
                iconSpan.className = 'icon';
                iconSpan.textContent = order.icon;

                const detailsDiv = document.createElement('div');
                detailsDiv.className = 'order-details';

                const desc = document.createElement('div');
                desc.className = 'info';
                desc.innerHTML = `<strong>${order.waiter}</strong><br/>
                    ${order.icon} ${order.product} ‚Ä¢ ${order.sectorName} ‚Ä¢ ${order.timestamp}`;

                const metricsDiv = document.createElement('div');
                metricsDiv.className = 'metrics';
                metricsDiv.innerHTML = `<span class="time">‚è±Ô∏è ${order.estimatedTime}min</span>
                    <span class="processing">‚ö° ${order.processingTime}ms</span>`;

                detailsDiv.appendChild(desc);
                detailsDiv.appendChild(metricsDiv);
                div.appendChild(iconSpan);
                div.appendChild(detailsDiv);
                ordersContainer.appendChild(div);
            });
        }

        function updateStats() {
            const avgTime = stats.processingTimes.length > 0
                ? Math.round(stats.processingTimes.reduce((a, b) => a + b, 0) / stats.processingTimes.length)
                : 0;

            const setStat = (id, value, suffix = '') => {
                const el = document.getElementById(id);
                const num = el.querySelector('.stat-number');
                if (num) num.innerText = value + suffix;
            };

            setStat('totalOrders', stats.totalOrders);
            setStat('mediatorCalls', stats.mediatorCalls);
            setStat('avgTime', avgTime, ' ms');
            setStat('barOrders', stats.sectorOrders.bar);
            setStat('kitchenOrders', stats.sectorOrders.cozinha);
            setStat('baristaOrders', stats.sectorOrders.barista);
        }

        function clearOrders() {
            orders = [];
            stats = {
                totalOrders: 0,
                mediatorCalls: 0,
                processingTimes: [],
                sectorOrders: { bar: 0, cozinha: 0, barista: 0 }
            };
            updateDisplay();
            updateStats();
        }

        // Inicializa√ß√£o
        updateStats();
    </script>

    <style>
        :root {
            --bg: #f6f8fa;
            --surface: #ffffff;
            --muted: #6a737d;
            --border: #e1e4e8;
            --accent: #0366d6;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #d73a49;
            --shadow: 0 1px 2px rgba(27, 31, 35, 0.04), 0 8px 24px rgba(27, 31, 35, 0.08);
        }

        html, body {
            height: 100%;
        }

        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial;
            background: var(--bg);
            color: #24292e;
            -webkit-font-smoothing: antialiased;
        }

        .container {
            max-width: 1100px;
            margin: 32px auto;
            padding: 20px;
        }

        h1 {
            font-size: 1.6rem;
            margin: 0 0 8px 0;
            color: #0b2d4a;
        }

        h2 {
            font-size: 1.2rem;
            margin: 0 0 12px 0;
            color: #24292e;
        }

        h3 {
            font-size: 1.1rem;
            margin: 0 0 12px 0;
            color: #24292e;
        }

        .card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 8px;
            box-shadow: var(--shadow);
            padding: 18px;
            margin-bottom: 18px;
        }

        /* Estat√≠sticas em grid responsivo */
        .stats {
            display: grid;
            grid-template-columns: repeat(6, minmax(0, 1fr));
            gap: 12px;
            margin-bottom: 14px;
        }

        .stat {
            display: flex;
            gap: 12px;
            align-items: center;
            padding: 14px;
            border-radius: 10px;
            background: linear-gradient(180deg, #ffffff, #fbfdff);
            border: 1px solid var(--border);
        }

        .stat-icon {
            width: 48px;
            height: 48px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.4rem;
            background: rgba(3, 102, 214, 0.08);
            color: var(--accent);
            flex-shrink: 0;
        }

        .stat-content {
            display: flex;
            flex-direction: column;
        }

        .stat-number {
            font-size: 1.4rem;
            font-weight: 700;
            color: #092a4a;
        }

        .stat-label {
            font-size: 0.75rem;
            color: var(--muted);
            margin-top: 2px;
            line-height: 1.2;
        }

        /* Controles */
        .control-group {
            display: flex;
            gap: 16px;
            margin-bottom: 12px;
            flex-wrap: wrap;
        }

        .waiter-select, .order-type-select {
            display: flex;
            flex-direction: column;
            gap: 6px;
            flex: 1;
            min-width: 200px;
        }

        .waiter-select label, .order-type-select label {
            font-size: 0.9rem;
            font-weight: 600;
            color: #24292e;
        }

        select {
            padding: 8px 12px;
            border-radius: 6px;
            border: 1px solid var(--border);
            background: var(--surface);
            cursor: pointer;
            font-size: 0.95rem;
        }

        select:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(3, 102, 214, 0.1);
        }

        .buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        button {
            padding: 8px 12px;
            border-radius: 6px;
            border: 1px solid var(--border);
            background: var(--surface);
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.2s;
        }

        button:hover {
            opacity: 0.95;
            transform: translateY(-1px);
        }

        button.add {
            background: var(--accent);
            color: #fff;
            border-color: transparent;
        }

        button.bulk-10 {
            background: #2ea44f;
            color: #fff;
            border-color: transparent;
        }

        button.bulk-50 {
            background: #6f42c1;
            color: #fff;
            border-color: transparent;
        }

        button.bulk-100 {
            background: var(--danger);
            color: #fff;
            border-color: transparent;
        }

        button.clear {
            background: transparent;
        }

        /* Pedidos */
        .orders {
            max-height: 500px;
            overflow-y: auto;
        }

        .order {
            display: flex;
            gap: 12px;
            align-items: center;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid var(--border);
            background: linear-gradient(180deg, #fff, #fcfeff);
            margin-top: 10px;
            transition: all 0.2s;
        }

        .order:hover {
            background: linear-gradient(180deg, #fff, #f8fbff);
            border-color: var(--accent);
        }

        .order .icon {
            width: 48px;
            height: 48px;
            border-radius: 8px;
            background: linear-gradient(180deg, #f1f7fd, #fff);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.4rem;
            flex-shrink: 0;
        }

        .order .order-details {
            flex: 1;
        }

        .order .info {
            font-size: 0.95rem;
            line-height: 1.4;
        }

        .order .info strong {
            color: #092a4a;
            font-weight: 600;
        }

        .order .metrics {
            display: flex;
            gap: 12px;
            margin-top: 6px;
            font-size: 0.85rem;
        }

        .order .metrics span {
            padding: 4px 8px;
            border-radius: 4px;
            background: rgba(3, 102, 214, 0.08);
            color: var(--accent);
        }

        /* Explica√ß√£o */
        .explanation {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 12px;
            margin-top: 12px;
        }

        .concept {
            padding: 12px;
            border-radius: 6px;
            background: #f6f8fa;
            border-left: 4px solid var(--accent);
        }

        .concept strong {
            color: #092a4a;
        }

        .concept p {
            margin: 6px 0 0 0;
            font-size: 0.9rem;
            color: #24292e;
        }

        .concept ul {
            margin: 6px 0 0 0;
            padding-left: 18px;
            font-size: 0.9rem;
        }

        .concept li {
            margin: 4px 0;
        }

        /* Scrollbar personalizada */
        .orders::-webkit-scrollbar {
            width: 8px;
        }

        .orders::-webkit-scrollbar-track {
            background: #f0f0f0;
            border-radius: 10px;
        }

        .orders::-webkit-scrollbar-thumb {
            background: #ccc;
            border-radius: 10px;
        }

        .orders::-webkit-scrollbar-thumb:hover {
            background: #999;
        }

        /* Responsividade */
        @media (max-width: 1000px) {
            .stats {
                grid-template-columns: repeat(3, minmax(0, 1fr));
            }
        }

        @media (max-width: 700px) {
            .stats {
                grid-template-columns: repeat(2, minmax(0, 1fr));
            }

            .control-group {
                flex-direction: column;
            }

            .waiter-select, .order-type-select {
                min-width: 100%;
            }

            .buttons {
                flex-direction: column;
            }

            button {
                width: 100%;
            }

            .order {
                flex-direction: column;
                align-items: flex-start;
            }

            .order .metrics {
                width: 100%;
            }
        }

        @media (max-width: 500px) {
            .stats {
                grid-template-columns: 1fr;
            }

            h1 {
                font-size: 1.3rem;
            }

            .container {
                margin: 16px auto;
                padding: 12px;
            }
        }
    </style>
</body>
</html>
